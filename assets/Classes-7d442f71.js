import{r as N,j as t,F as C,a1 as O}from"./index-8992e9dd.js";import{C as F}from"./CurrentClassses-8e582056.js";function j(o){const u=o.flatMap(s=>s.viewData),d=u.filter(s=>s[1]).flatMap(s=>Object.values(s)),i=u.filter(s=>s[2]).flatMap(s=>Object.values(s)),c=u.filter(s=>s[3]).flatMap(s=>Object.values(s)),x=u.filter(s=>s[4]).flatMap(s=>Object.values(s)),h=u.filter(s=>s[5]).flatMap(s=>Object.values(s));return!![d,i,c,x,h].some(s=>{if(s.length<=1)return!1;const f=s.at(-1);return!!s.slice(0,-1).some(m=>Number(m[0])>Number(f[0])?Number(f[1])>Number(m[0]):Number(m[0])<Number(f[0])?Number(f[0])<Number(m[1]):Number(m[0])===Number(f[0]))})}function M({input:o,classes:u,setLoading:d}){N.useEffect(()=>{d(!0)},[]);let i=o.split(",");i=i.map(e=>e.trim());const{chosenClasses:c,setChosenClasses:x,setHoveredClass:h}=N.useContext(F);function s(e,l){const p=["[0-9]","[0-9]","[0-9]","-","[0-9A-Z]","[0-9A-Z]","[0-9A-Z]","-","[0-9A-Z]","[0-9A-Z]"].slice(0,e.length).join(""),A=new RegExp(p);if(e==="@")return l.filter(r=>c.some(g=>r.code===g.code&&r.section===g.section)||c.some(g=>r.code===g.code)?!1:!j([...c,r]));if(["r>","r<","r="].includes(e.slice(0,2))&&e.length>2){if(!Number(e.slice(2)))return[];const r=Number(e.slice(2));switch(e[1]){case"=":return l.filter(n=>n.lecture.rating.avg===r);case">":return l.filter(n=>n.lecture.rating.avg>=r);case"<":return l.filter(n=>n.lecture.rating.avg<=r)}}else if(["s>","s<","s="].includes(e.slice(0,2))&&e.length>2){if(!Number(e.slice(2)))return[];const r=Number(e.slice(2));switch(e[1]){case"=":return l.filter(n=>n.lecture.rating.score===r);case">":return l.filter(n=>n.lecture.rating.score>=r);case"<":return l.filter(n=>n.lecture.rating.score<=r)}}else if(e.slice(0,2)==="p="){const r=e.slice(2).toLowerCase();return l.filter(n=>n.lecture.prof.toLowerCase().includes(r))}else{if(A.test(e))return l.filter(r=>r.code.includes(e));if(e.split("").every(r=>"MTWRF".includes(r)))return l.filter(r=>{const n=structuredClone(Object.keys(r.lecture)),g=structuredClone(Object.keys(r.lab));return n.filter(b=>!["title","prof","rating"].includes(b)).concat(g.filter(b=>!["title","prof","rating"].includes(b))).join("").includes(e)});if(e.toUpperCase()===e)return l.filter(r=>r.course.includes(e));if(["honours","blended"].some(r=>r===e.toLowerCase())){const r=e.toLowerCase();if("honours".startsWith(r))return l.filter(n=>n.more.startsWith("For Honours"));if("blended".startsWith(r))return l.filter(n=>n.more.startsWith("BLENDED"))}else return l.filter(r=>r.lecture.title.toLowerCase().includes(e.toLowerCase()))}return[]}let f=s(i[0],u);i.slice(1).forEach(e=>{f=s(e,f)});function m(e){if(c.some(l=>e.code===l.code&&e.section===l.section))x(c.filter(l=>!(e.code===l.code&&e.section===l.section)));else if(c.some(l=>e.code===l.code)){alert("You already have a class from this course");return}else{if(j([...c,e])){alert("The chosen class overlaps with another!");return}x([...c,e])}}return t.jsx(t.Fragment,{children:f.map((e,l)=>t.jsxs("div",{className:"bg-c2 p-2 box-border md:mb-3 mb-2 rounded-lg md:shadow-lg shadow-md hover:bg-c3 transition cursor-pointer md:text-base text-xs",onClick:()=>m(e),onPointerOver:a=>{a.stopPropagation(),h(e)},onPointerOut:()=>{h(void 0)},children:[t.jsxs("p",{className:"font-light",children:[e.program,": ",e.course," ",e.code]}),t.jsxs("p",{className:"md:text-xl font-bold text-base",children:[e.section," ",e.lecture.title]}),t.jsxs("div",{className:"ml-4 relative",children:[e.lecture.prof," ",t.jsx("span",{className:"font-bold",children:e.lecture.rating.score===0||!e.lecture.rating.score?"N/A":e.lecture.rating.score})," ",t.jsx(v,{rating:e.lecture.rating})]}),Object.entries(e.lecture).filter(a=>!["title","prof","rating"].includes(a[0])).map((a,p)=>t.jsxs("p",{className:"ml-8 font-extralight",children:[t.jsx("span",{className:"font-normal",children:a[0]})," ",a[1]]},p)),"prof"in e.lab&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"ml-4 relative",children:[t.jsx("u",{children:"Lab"}),": ",e.lab.prof," ",t.jsx("span",{className:"font-bold",children:e.lab.rating.score===0||!e.lab.rating.score?"N/A":e.lab.rating.score})," ",t.jsx(v,{rating:e.lab.rating})]}),Object.entries(e.lab).filter(a=>!["title","prof","rating"].includes(a[0])).map((a,p)=>t.jsxs("p",{className:"ml-8 font-extralight",children:[t.jsx("span",{className:"font-normal",children:a[0]})," ",a[1]]},p))]}),e.more!==""&&t.jsx(t.Fragment,{children:t.jsx("p",{className:"text-c6",children:e.more})})]},`i.code + ${l}`))})}function v({rating:o}){const[u,d]=N.useState(!1),i=o.avg;return t.jsxs(t.Fragment,{children:[t.jsx(C,{icon:O,className:"cursor-pointer",onPointerOver:()=>d(!0),onPointerOut:()=>d(!1)}),u&&t.jsxs("div",{className:"absolute top-0 left-0 mt-6 bg-[white] rounded-lg p-2 z-10 text-xs flex",children:[t.jsx("p",{className:"w-full",children:"The score is calculated to take into account the number of raters. A high rating with low raters will perform worse in comparison to a lower rating with many raters."}),t.jsxs("ul",{className:"pl-4 shrink-0",children:[t.jsxs("li",{className:"list-disc",children:["Rating: ",i===0||!i?"N/A":`${o.avg}/5`]}),t.jsxs("li",{className:"list-disc",children:["Raters: ",i===0||!i?"N/A":o.nRating]}),t.jsxs("li",{className:"list-disc",children:["Take Again:"," ",i===0||!i?"N/A":`${o.takeAgain.toFixed(1)}%`]}),t.jsxs("li",{className:"list-disc",children:["Difficulty: ",i===0||!i?"N/A":`${o.difficulty}/5`]})]})]})]})}export{M as default};
